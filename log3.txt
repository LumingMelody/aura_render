}, {'id': 'clip_76b8db27', 'index': 1, 'asset_id': 'placeholder_1', 'source_url': 'https://example.com/assets/placeholder.mp4', 'start': 5.5, 'end': 10.5, 'duration': 5.0, 'source': {'in': 0.0, 'out': 5.0}, 'transition_in': {'type': 'cross_dissolve', 'duration': 0.5}, 'transition_out': {'type': 'none', 'duration': 0.0}, 'metadata': {'description': 'ä¸€åªæˆ´ç€ç²¾è‡´æˆ’æŒ‡çš„æ‰‹è½»è½»åˆ’è¿‡æ³³æ± æ°´é¢ï¼Œæ¿€èµ·ç»†å¾®çš„æ°´èŠ±ï¼Œåœ¨é˜³å…‰ä¸‹é—ªè€€ç€å…‰èŠ’ã€‚', 'provider': 'system_placeholder', 'original_block': {'shot_type': 'ç‰¹å†™', 'duration': 5.0, 'visual_description': 'ä¸€åªæˆ´ç€ç²¾è‡´æˆ’æŒ‡çš„æ‰‹è½»è½»åˆ’è¿‡æ³³æ± æ°´é¢ï¼Œæ¿€èµ·ç»†å¾®çš„æ°´èŠ±ï¼Œåœ¨é˜³å…‰ä¸‹é—ªè€€ç€å…‰èŠ’ã€‚', 'pacing': 'æ…¢é•œå¤´', 'caption': 'ä¼˜é›…æ—¶åˆ»ï¼Œ#æ•æ‰ç¾å¥½', 'start_time': 5.0, 'end_time': 10.0}}, 'transform': {'scale': 1.0, 'position': 'center'}}]
ğŸ” [DEBUG] Checking parameter 'style_config_id': exists=False, value=NOT_FOUND
INFO:llm.qwen:âœ… DashScope APIå¯†é’¥å·²è®¾ç½®: sk-a48a1d84e...
[å…¨å±€åˆ†æ] ä¸»åŸºè°ƒ: dreamy
ERROR:app:VGPèŠ‚ç‚¹æ‰§è¡Œå¤±è´¥ filter_application: 'clip_id'
ğŸ” [VGP] Node filter_application outputs: ['node_id']
âœ… [DAG] Node 7 completed: filter_application (1.05s)
2025-10-16 05:59:09,792 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:09,792 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
2025-10-16 05:59:09,792 INFO sqlalchemy.engine.Engine UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
2025-10-16 05:59:09,792 INFO sqlalchemy.engine.Engine [cached since 373.8s ago] (81.25, 'DAGè¿›åº¦: 13/16 èŠ‚ç‚¹ - èŠ‚ç‚¹7æ‰§è¡Œå®Œæˆ: filter_application', 1)
INFO:sqlalchemy.engine.Engine:[cached since 373.8s ago] (81.25, 'DAGè¿›åº¦: 13/16 èŠ‚ç‚¹ - èŠ‚ç‚¹7æ‰§è¡Œå®Œæˆ: filter_application', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:09,793 INFO sqlalchemy.engine.Engine COMMIT
2025-10-16 05:59:09,797 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-10-16 05:59:09,797 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:09,797 INFO sqlalchemy.engine.Engine [cached since 386.9s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 386.9s ago] (1,)
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 7: completed - èŠ‚ç‚¹7æ‰§è¡Œå®Œæˆ: filter_application
2025-10-16 05:59:09,798 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
WHERE tasks.task_id = ?
FROM tasks
 LIMIT ? OFFSET ?
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:09,798 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,798 INFO sqlalchemy.engine.Engine UPDATE tasks SET message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET message=? WHERE tasks.id = ?
2025-10-16 05:59:09,798 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('DAGè¿›åº¦: 13/16 èŠ‚ç‚¹ - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹11: audio_processing', 1)
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('DAGè¿›åº¦: 13/16 èŠ‚ç‚¹ - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹11: audio_processing', 1)
2025-10-16 05:59:09,799 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:09,801 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-10-16 05:59:09,801 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
WHERE tasks.id = ?
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:09,801 INFO sqlalchemy.engine.Engine [cached since 386.9s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 386.9s ago] (1,)
âš¡ [DAG] Executing node 11/16: audio_processing
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 11: started - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹11: audio_processing
INFO:app:ğŸ¬ æ‰§è¡ŒVGPèŠ‚ç‚¹: audio_processing - éŸ³é¢‘å¤„ç†

ğŸ¬ [execute_node] Starting node: audio_processing
ğŸ¬ [execute_node] Input context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id']
ğŸ¬ [execute_node] context[theme_id] = ç¾å¥³æ¸¸æ³³
ğŸ¬ [execute_node] context[keywords_id] = ['ç¾å¥³', 'æ³³æ± ']
ğŸ¬ [execute_node] context[target_duration_id] = 10
ğŸ¬ [execute_node] context[user_description_id] = ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ¬ [execute_node] Fixed context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id']

================================================================================
ğŸ” [prepare_context_for_node] node_type=audio_processing
ğŸ” [prepare_context_for_node] raw_context keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id']
ğŸ” [prepare_context_for_node] input_data (before)=['bgm_composition_id', 'bgm_file_path', 'sfx_track_id', 'sfx_timeline', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
INFO:video_generate_protocol.vgp_data_transformer:prepare_context_for_node: node_type=audio_processing, raw_context keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id']
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ theme_id in raw_context: ç¾å¥³æ¸¸æ³³
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ keywords_id in raw_context: ['ç¾å¥³', 'æ³³æ± ']
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ target_duration_id in raw_context: 10
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ user_description_id in raw_context: ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ” [prepare_context_for_node] input_data (after)=['bgm_composition_id', 'bgm_file_path', 'sfx_track_id', 'sfx_timeline', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ” [prepare_context_for_node] Final values:
    theme_id: ç¾å¥³æ¸¸æ³³
    keywords_id: ['ç¾å¥³', 'æ³³æ± ']
    target_duration_id: 10
    user_description_id: ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
================================================================================

INFO:video_generate_protocol.vgp_data_transformer:prepare_context_for_node: æœ€ç»ˆå‡†å¤‡çš„ input_data keys=['bgm_composition_id', 'bgm_file_path', 'sfx_track_id', 'sfx_timeline', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ¬ [execute_node] Prepared input keys: ['bgm_composition_id', 'bgm_file_path', 'sfx_track_id', 'sfx_timeline', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ¬ [execute_node] Execution context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'bgm_file_path', 'sfx_timeline']
ğŸ¬ [execute_node] execution_context[theme_id] = ç¾å¥³æ¸¸æ³³
ğŸ¬ [execute_node] execution_context[keywords_id] = ['ç¾å¥³', 'æ³³æ± ']
ğŸ¬ [execute_node] execution_context[target_duration_id] = 10
ğŸ¬ [execute_node] execution_context[user_description_id] = ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ¬ [execute_node] Calling node.generate()...

ğŸ” [DEBUG] Node éŸ³é¢‘å¤„ç† validation:
ğŸ” [DEBUG] Context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'bgm_file_path', 'sfx_timeline']
ğŸ” [DEBUG] Required inputs: ['bgm_composition_id', 'sfx_track_id', 'tts_track_id']
ğŸ” [DEBUG] Checking parameter 'bgm_composition_id': exists=True, value=default_bgm_001
ERROR:app:VGPèŠ‚ç‚¹æ‰§è¡Œå¤±è´¥ audio_processing: cannot access local variable 'parsed' where it is not associated with a value
ğŸ” [VGP] Node audio_processing outputs: ['node_id']
âœ… [DAG] Node 11 completed: audio_processing (0.00s)
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
2025-10-16 05:59:09,802 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:09,802 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,803 INFO sqlalchemy.engine.Engine UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
2025-10-16 05:59:09,803 INFO sqlalchemy.engine.Engine [cached since 373.8s ago] (87.5, 'DAGè¿›åº¦: 14/16 èŠ‚ç‚¹ - èŠ‚ç‚¹11æ‰§è¡Œå®Œæˆ: audio_processing', 1)
INFO:sqlalchemy.engine.Engine:[cached since 373.8s ago] (87.5, 'DAGè¿›åº¦: 14/16 èŠ‚ç‚¹ - èŠ‚ç‚¹11æ‰§è¡Œå®Œæˆ: audio_processing', 1)
2025-10-16 05:59:09,803 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:09,806 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-10-16 05:59:09,806 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:09,806 INFO sqlalchemy.engine.Engine [cached since 386.9s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 386.9s ago] (1,)
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 11: completed - èŠ‚ç‚¹11æ‰§è¡Œå®Œæˆ: audio_processing
ğŸ”„ [DAG] Launching 1 parallel nodes: [8]
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
2025-10-16 05:59:09,806 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,806 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,807 INFO sqlalchemy.engine.Engine UPDATE tasks SET message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET message=? WHERE tasks.id = ?
2025-10-16 05:59:09,807 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('DAGè¿›åº¦: 14/16 èŠ‚ç‚¹ - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹8: dynamic_effects', 1)
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('DAGè¿›åº¦: 14/16 èŠ‚ç‚¹ - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹8: dynamic_effects', 1)
2025-10-16 05:59:09,807 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:09,809 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-10-16 05:59:09,810 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 386.9s ago] (1,)
2025-10-16 05:59:09,810 INFO sqlalchemy.engine.Engine [cached since 386.9s ago] (1,)
âš¡ [DAG] Executing node 8/16: dynamic_effects
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 8: started - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹8: dynamic_effects
INFO:app:ğŸ¬ æ‰§è¡ŒVGPèŠ‚ç‚¹: dynamic_effects - åŠ¨æ€ç‰¹æ•ˆæ·»åŠ 

ğŸ¬ [execute_node] Starting node: dynamic_effects
ğŸ¬ [execute_node] Input context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing']
ğŸ¬ [execute_node] context[theme_id] = ç¾å¥³æ¸¸æ³³
ğŸ¬ [execute_node] context[keywords_id] = ['ç¾å¥³', 'æ³³æ± ']
ğŸ¬ [execute_node] context[target_duration_id] = 10
ğŸ¬ [execute_node] context[user_description_id] = ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'filters' for filter_application, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'filter_timeline' for filter_application, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'filter_parameters' for filter_application, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'audio_track_id' for audio_processing, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'audio_file_path' for audio_processing, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'audio_duration' for audio_processing, using default
ğŸ¬ [execute_node] Fixed context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing']

================================================================================
ğŸ” [prepare_context_for_node] node_type=dynamic_effects
ğŸ” [prepare_context_for_node] raw_context keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing']
ğŸ” [prepare_context_for_node] input_data (before)=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
INFO:video_generate_protocol.vgp_data_transformer:prepare_context_for_node: node_type=dynamic_effects, raw_context keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing']
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ theme_id in raw_context: ç¾å¥³æ¸¸æ³³
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ keywords_id in raw_context: ['ç¾å¥³', 'æ³³æ± ']
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ target_duration_id in raw_context: 10
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ user_description_id in raw_context: ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ” [prepare_context_for_node] input_data (after)=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ” [prepare_context_for_node] Final values:
    theme_id: ç¾å¥³æ¸¸æ³³
    keywords_id: ['ç¾å¥³', 'æ³³æ± ']
    target_duration_id: 10
INFO:video_generate_protocol.vgp_data_transformer:prepare_context_for_node: æœ€ç»ˆå‡†å¤‡çš„ input_data keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
    user_description_id: ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
================================================================================

ğŸ¬ [execute_node] Prepared input keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ¬ [execute_node] Execution context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing']
ğŸ¬ [execute_node] execution_context[theme_id] = ç¾å¥³æ¸¸æ³³
ğŸ¬ [execute_node] execution_context[keywords_id] = ['ç¾å¥³', 'æ³³æ± ']
ğŸ¬ [execute_node] execution_context[target_duration_id] = 10
ğŸ¬ [execute_node] execution_context[user_description_id] = ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ¬ [execute_node] Calling node.generate()...

ğŸ” [DEBUG] Node åŠ¨æ€ç‰¹æ•ˆæ·»åŠ  validation:
ğŸ” [DEBUG] Context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing']
ğŸ” [DEBUG] Required inputs: ['filter_sequence_id', 'emotions_id', 'resolution']
ğŸ” [DEBUG] Checking parameter 'filter_sequence_id': exists=False, value=NOT_FOUND
ğŸ” [DEBUG] Checking parameter 'emotions_id': exists=True, value={'æµªæ¼«': 44, 'æ¸©é¦¨': 38, 'æ„ŸåŠ¨': 18}
ğŸ” [DEBUG] Checking parameter 'resolution': exists=False, value=NOT_FOUND
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'effects' for dynamic_effects, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'effect_timeline' for dynamic_effects, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'effect_parameters' for dynamic_effects, using default
INFO:app:âœ… VGPèŠ‚ç‚¹æ‰§è¡ŒæˆåŠŸ: dynamic_effects
ğŸ” [VGP] Node dynamic_effects outputs: ['effects', 'effects_sequence_id']
âœ… [DAG] Node 8 completed: dynamic_effects (0.00s)
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,811 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:09,811 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,811 INFO sqlalchemy.engine.Engine UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
2025-10-16 05:59:09,811 INFO sqlalchemy.engine.Engine [cached since 373.8s ago] (93.75, 'DAGè¿›åº¦: 15/16 èŠ‚ç‚¹ - èŠ‚ç‚¹8æ‰§è¡Œå®Œæˆ: dynamic_effects', 1)
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.8s ago] (93.75, 'DAGè¿›åº¦: 15/16 èŠ‚ç‚¹ - èŠ‚ç‚¹8æ‰§è¡Œå®Œæˆ: dynamic_effects', 1)
2025-10-16 05:59:09,812 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-10-16 05:59:09,814 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-10-16 05:59:09,814 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 386.9s ago] (1,)
2025-10-16 05:59:09,815 INFO sqlalchemy.engine.Engine [cached since 386.9s ago] (1,)
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 8: completed - èŠ‚ç‚¹8æ‰§è¡Œå®Œæˆ: dynamic_effects
ğŸ”„ [DAG] Launching 1 parallel nodes: [16]
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:09,815 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:09,815 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:09,816 INFO sqlalchemy.engine.Engine UPDATE tasks SET message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 386.6s ago] ('DAGè¿›åº¦: 15/16 èŠ‚ç‚¹ - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹16: timeline_integration', 1)
2025-10-16 05:59:09,816 INFO sqlalchemy.engine.Engine [cached since 386.6s ago] ('DAGè¿›åº¦: 15/16 èŠ‚ç‚¹ - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹16: timeline_integration', 1)
2025-10-16 05:59:09,816 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:09,820 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
2025-10-16 05:59:09,820 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:09,820 INFO sqlalchemy.engine.Engine [cached since 386.9s ago] (1,)
WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 386.9s ago] (1,)
âš¡ [DAG] Executing node 16/16: timeline_integration
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 16: started - å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹16: timeline_integration
INFO:app:ğŸ¬ æ‰§è¡ŒVGPèŠ‚ç‚¹: timeline_integration - æœ€ç»ˆæ—¶é—´çº¿æ•´åˆ

ğŸ¬ [execute_node] Starting node: timeline_integration
ğŸ¬ [execute_node] Input context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing', 'dynamic_effects', 'effects', 'effects_sequence_id']
ğŸ¬ [execute_node] context[theme_id] = ç¾å¥³æ¸¸æ³³
ğŸ¬ [execute_node] context[keywords_id] = ['ç¾å¥³', 'æ³³æ± ']
ğŸ¬ [execute_node] context[target_duration_id] = 10
ğŸ¬ [execute_node] context[user_description_id] = ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'filters' for filter_application, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'filter_timeline' for filter_application, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'filter_parameters' for filter_application, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'audio_track_id' for audio_processing, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'audio_file_path' for audio_processing, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'audio_duration' for audio_processing, using default
ğŸ¬ [execute_node] Fixed context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing', 'dynamic_effects', 'effects', 'effects_sequence_id']
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing dependency field 'audio_tracks' from audio_processing for timeline_integration

================================================================================
ğŸ” [prepare_context_for_node] node_type=timeline_integration
ğŸ” [prepare_context_for_node] raw_context keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing', 'dynamic_effects', 'effects', 'effects_sequence_id']
ğŸ” [prepare_context_for_node] input_data (before)=['assets', 'asset_timeline', 'video_clips', 'keyframes', 'audio_tracks', 'transitions', 'transition_timeline', 'filters', 'filter_timeline', 'subtitles', 'subtitle_timeline', 'intro_outro_sequence', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
INFO:video_generate_protocol.vgp_data_transformer:prepare_context_for_node: node_type=timeline_integration, raw_context keys=['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing', 'dynamic_effects', 'effects', 'effects_sequence_id']
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ theme_id in raw_context: ç¾å¥³æ¸¸æ³³
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ keywords_id in raw_context: ['ç¾å¥³', 'æ³³æ± ']
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ target_duration_id in raw_context: 10
ğŸ” [prepare_context_for_node] å‘ç°å­—æ®µ user_description_id in raw_context: ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ” [prepare_context_for_node] input_data (after)=['assets', 'asset_timeline', 'video_clips', 'keyframes', 'audio_tracks', 'transitions', 'transition_timeline', 'filters', 'filter_timeline', 'subtitles', 'subtitle_timeline', 'intro_outro_sequence', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ” [prepare_context_for_node] Final values:
    theme_id: ç¾å¥³æ¸¸æ³³
    keywords_id: ['ç¾å¥³', 'æ³³æ± ']
    target_duration_id: 10
    user_description_id: ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
================================================================================

INFO:video_generate_protocol.vgp_data_transformer:prepare_context_for_node: æœ€ç»ˆå‡†å¤‡çš„ input_data keys=['assets', 'asset_timeline', 'video_clips', 'keyframes', 'audio_tracks', 'transitions', 'transition_timeline', 'filters', 'filter_timeline', 'subtitles', 'subtitle_timeline', 'intro_outro_sequence', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ¬ [execute_node] Prepared input keys: ['assets', 'asset_timeline', 'video_clips', 'keyframes', 'audio_tracks', 'transitions', 'transition_timeline', 'filters', 'filter_timeline', 'subtitles', 'subtitle_timeline', 'intro_outro_sequence', 'theme_id', 'keywords_id', 'target_duration_id', 'user_description_id']
ğŸ¬ [execute_node] Execution context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing', 'dynamic_effects', 'effects', 'effects_sequence_id', 'assets', 'asset_timeline', 'video_clips', 'keyframes', 'audio_tracks', 'transition_timeline', 'filters', 'filter_timeline', 'subtitles', 'subtitle_timeline', 'intro_outro_sequence']
ğŸ¬ [execute_node] execution_context[theme_id] = ç¾å¥³æ¸¸æ³³
ğŸ¬ [execute_node] execution_context[keywords_id] = ['ç¾å¥³', 'æ³³æ± ']
ğŸ¬ [execute_node] execution_context[target_duration_id] = 10
ğŸ¬ [execute_node] execution_context[user_description_id] = ç¾å¥³åœ¨æ³³æ± é‡Œé¢æ¸¸æ³³ï¼Œå¤•é˜³ä¸‹ï¼Œé«˜æ¥¼å¤§å¦é¡¶éƒ¨ï¼Œå¥¹çš„èƒŒå½±æ ¼å¤–ç¾ä¸½
ğŸ¬ [execute_node] Calling node.generate()...

ğŸ” [DEBUG] Node æœ€ç»ˆæ—¶é—´çº¿æ•´åˆ validation:
ğŸ” [DEBUG] Context keys: ['theme_id', 'keywords_id', 'target_duration_id', 'user_description_id', 'reference_media', 'video_type_identification', 'video_type_id', 'structure_template_id', 'emotion_analysis', 'emotions_id', 'shot_block_generation', 'shot_blocks_id', 'bgm_anchor_planning', 'bgm_anchors', 'bgm_timeline', 'bgm_tracks_id', 'narrative_arc_id', 'asset_request', 'preliminary_sequence_id', 'total_main_duration_id', 'sfx_integration', 'sfx_track_id', 'aux_media_insertion', 'auxiliary_track_id', 'aux_text_insertion', 'text_overlay_track_id', 'subtitle_generation', 'subtitle_sequence_id', 'tts_track_id', 'intro_outro', 'transition_selection', 'transitions', 'transition_sequence_id', 'bgm_composition', 'bgm_composition_id', 'track_id', 'filter_application', 'node_id', 'audio_processing', 'dynamic_effects', 'effects', 'effects_sequence_id', 'assets', 'asset_timeline', 'video_clips', 'keyframes', 'audio_tracks', 'transition_timeline', 'filters', 'filter_timeline', 'subtitles', 'subtitle_timeline', 'intro_outro_sequence']
ğŸ” [DEBUG] Required inputs: ['video_clips', 'audio_tracks', 'subtitle_sequence', 'intro_outro_sequence']
ğŸ” [DEBUG] Checking parameter 'video_clips': exists=True, value=[{'url': 'https://dashscope-result-sh.oss-cn-shanghai.aliyuncs.com/1d/48/20251016/6f9474a6/7308d6e8-4df4-4756-8982-93c6d8e0bc7d.mp4?Expires=1760680656&OSSAccessKeyId=LTAI5tKPD3TMqf2Lna1fASuh&Signature=v%2BY53UABNju%2BhYQRK8G%2F3QycCns%3D', 'duration': 5.0}, {'url': 'https://dashscope-result-sh.oss-cn-shanghai.aliyuncs.com/1d/f3/20251016/21677ecc/e7105804-bd33-4e89-b306-85e05b98b20c.mp4?Expires=1760680747&OSSAccessKeyId=LTAI5tKPD3TMqf2Lna1fASuh&Signature=LwdCDQQXXeMug4Kb5C9v7jKB1Pg%3D', 'duration': 5.0}]
ğŸ” [DEBUG] Checking parameter 'audio_tracks': exists=True, value=[]
ğŸ” [DEBUG] Checking parameter 'subtitle_sequence': exists=False, value=NOT_FOUND
ğŸ” [DEBUG] Checking parameter 'intro_outro_sequence': exists=True, value={'intro': {'id': 'intro_7d98c377', 'type': 'intro', 'video_url': 'https://media.com/intro-logo-reveal.mp4', 'duration': 4.0, 'trim': {'start': 0.0, 'end': 4.0}, 'audio_embedded': True, 'source_duration': 4.0}, 'outro': {'id': 'outro_2d95e453', 'type': 'outro', 'video_url': 'https://media.com/outro-simple-fade.mp4', 'duration': 5.0, 'trim': {'start': 0.0, 'end': 5.0}, 'audio_embedded': True, 'source_duration': 5.0}, 'metadata': {'generated_at': '2025-10-16T05:55:44.047350', 'ai_decision': {'should_add_intro': True, 'should_add_outro': True, 'reasoning': 'Based on shot list analysis', 'style_category': 'åŠ¨æ„Ÿ', 'suggested_duration': 5.0}, 'forced': {'intro': False, 'outro': False}, 'video_topic': '', 'total_shots': 2}}
ğŸ¬ [Node 16] Starting final video composition...
ğŸ“Š [Node 16] Received 2 video clips from Node 5
ğŸ¬ [Node 16] ä½¿ç”¨é˜¿é‡Œäº‘IMS APIåˆå¹¶è§†é¢‘...
ğŸ“Š [Node 16] å¾…åˆå¹¶è§†é¢‘æ•°é‡: 2
âœ… OSSä¸Šä¼ å™¨åˆå§‹åŒ–æˆåŠŸï¼Œå°†ä½¿ç”¨OSS URLæ–¹å¼
ğŸ”— [Node 16] Merging 2 clips into final video...
ğŸ¬ ä½¿ç”¨é˜¿é‡Œäº‘IMSåˆå¹¶ 2 ä¸ªè§†é¢‘ç‰‡æ®µ...
   è§†é¢‘URLç¤ºä¾‹: https://dashscope-result-sh.oss-cn-shanghai.aliyuncs.com/1d/48/20251016/6f9474a6...
ğŸ“‹ Timelineé…ç½®: {
  "VideoTracks": [
    {
      "VideoTrackClips": [
        {
          "MediaURL": "https://dashscope-result-sh.oss-cn-shanghai.aliyuncs.com/1d/48/20251016/6f9474a6/7308d6e8-4df4-4756-8982-93c6d8e0bc7d.mp4?Expires=1760680656&OSSAccessKeyId=LTAI5tKPD3TMqf2Lna1fASuh&Signature=v%2BY53UABNju%2BhYQRK8G%2F3QycCns%3D"
        },
        {
          "MediaURL": "https://dashscope-result-sh.oss-cn-shanghai.aliyuncs.com/1d/f3/20251016/21677ecc/e7105804-bd33-4e89-b306-85e05b98b20c.mp4?Expires=1760680747&OSSAccessKeyId=LTAI5tKPD3TMqf2Lna1fASuh&Signature=LwdCDQQXXeMug4Kb5C9v7jKB1Pg%3D"
        }
      ]
    }
  ]
}
âœ… IMSåˆå¹¶ä»»åŠ¡å·²æäº¤, JobId: a5eb321124a24031896b3f9ca9361af1
â³ IMSåˆå¹¶ä¸­... (Init)
â³ IMSåˆå¹¶ä¸­... (Init)
â³ IMSåˆå¹¶ä¸­... (Init)
127.0.0.1:58776 - "GET /health HTTP/1.1" 200
â³ IMSåˆå¹¶ä¸­... (Init)
â³ IMSåˆå¹¶ä¸­... (Processing)
â³ IMSåˆå¹¶ä¸­... (Processing)
â³ IMSåˆå¹¶ä¸­... (Processing)
âœ… IMSåˆå¹¶å®Œæˆ
   ğŸ¬ æœ€ç»ˆè§†é¢‘URL: https://ai-movie-cloud-v2.oss-cn-shanghai.aliyuncs.com/merged_videos/final_video_abe689f5.mp4

================================================================================
âœ… [Node 16] æœ€ç»ˆè§†é¢‘åˆæˆæˆåŠŸï¼
================================================================================
ğŸ¬ æœ€ç»ˆè§†é¢‘URL: https://ai-movie-cloud-v2.oss-cn-shanghai.aliyuncs.com/merged_videos/final_video_abe689f5.mp4
================================================================================

WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'timeline_data' for timeline_integration, using default
WARNING:video_generate_protocol.vgp_data_transformer.VGPDataMapper:Missing required field 'total_duration' for timeline_integration, using default
INFO:app:âœ… VGPèŠ‚ç‚¹æ‰§è¡ŒæˆåŠŸ: timeline_integration
ğŸ” [VGP] Node timeline_integration outputs: []
âœ… [DAG] Node 16 completed: timeline_integration (35.64s)
2025-10-16 05:59:45,456 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
WHERE tasks.task_id = ?
FROM tasks
 LIMIT ? OFFSET ?
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:45,456 INFO sqlalchemy.engine.Engine [cached since 422.2s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:[cached since 422.2s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:45,457 INFO sqlalchemy.engine.Engine UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET progress=?, message=? WHERE tasks.id = ?
2025-10-16 05:59:45,457 INFO sqlalchemy.engine.Engine [cached since 409.5s ago] (100.0, 'DAGè¿›åº¦: 16/16 èŠ‚ç‚¹ - èŠ‚ç‚¹16æ‰§è¡Œå®Œæˆ: timeline_integration', 1)
INFO:sqlalchemy.engine.Engine:[cached since 409.5s ago] (100.0, 'DAGè¿›åº¦: 16/16 èŠ‚ç‚¹ - èŠ‚ç‚¹16æ‰§è¡Œå®Œæˆ: timeline_integration', 1)
2025-10-16 05:59:45,458 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:45,462 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
2025-10-16 05:59:45,463 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:45,463 INFO sqlalchemy.engine.Engine [cached since 422.5s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 422.5s ago] (1,)
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 16: completed - èŠ‚ç‚¹16æ‰§è¡Œå®Œæˆ: timeline_integration
ğŸ‰ [DAG] DAG execution completed in 422.24s
ğŸ“Š [DAG] Completed nodes: 16/16
ğŸ“Š [VGP] DAG execution summary:
   total_nodes: 16
   completed_nodes: 16
   node_mapping: {1: 'video_type_identification', 2: 'emotion_analysis', 3: 'shot_block_generation', 4: 'bgm_anchor_planning', 5: 'asset_request', 6: 'transition_selection', 7: 'filter_application', 8: 'dynamic_effects', 9: 'bgm_composition', 10: 'sfx_integration', 11: 'audio_processing', 12: 'aux_media_insertion', 13: 'aux_text_insertion', 14: 'subtitle_generation', 15: 'intro_outro', 16: 'timeline_integration'}
   execution_order: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]
   node_results_keys: [1, 2, 3, 4, 10, 12, 13, 14, 15, 5, 6, 9, 7, 11, 8, 16]
ğŸ“‹ [VGP] Analysis summary: {'video_type': 'æœªçŸ¥', 'emotions': {}, 'shot_count': 0, 'asset_count': 0, 'subtitle_count': 0}
ğŸ“Š [VGP] Video generation completed in Node 5, final composition in Node 16
ğŸ¥ [VGP] Node 5 generated 2 video clips
âœ… [VGP] Video generation status: Success
ğŸ‰ [VGP] Final video composition completed
INFO:video_generate_protocol.vgp_protocol.VGPWriter:Successfully wrote VGP document: fb0effda-1780-4124-84a3-abc2346dccd7
INFO:video_generate_protocol.vgp_protocol.VGPWriter:VGP document saved to: /app/vgp_documents/fb0effda-1780-4124-84a3-abc2346dccd7.vgp.json
INFO:video_generate_protocol.vgp_protocol.VGPProtocol:VGP document saved: /app/vgp_documents/fb0effda-1780-4124-84a3-abc2346dccd7.vgp.json
ğŸ“„ [VGP] Document saved: /app/vgp_documents/fb0effda-1780-4124-84a3-abc2346dccd7.vgp.json
create_resourceè¯·æ±‚ä½“ä¸º{'type': 1, 'name': 'VGPè§†é¢‘-ç¾å¥³æ¸¸æ³³', 'path': 'merged_videos/final_video_abe689f5.mp4', 'fileType': 'mp4', 'size': 0, 'configName': 'oss-ali-shanghai', 'tenantId': '1'}
âœ… èµ„æºä¿å­˜æˆåŠŸ: VGPè§†é¢‘-ç¾å¥³æ¸¸æ³³ -> https://ai-movie-cloud-v2.oss-cn-shanghai.aliyuncs.com/merged_videos/final_video_abe689f5.mp4
ğŸ“¤ å“åº”: {"code":0,"data":853,"msg":""}
âœ… [VGP] èµ„æºåˆ›å»ºæˆåŠŸ: https://ai-movie-cloud-v2.oss-cn-shanghai.aliyuncs.com/merged_videos/final_video_abe689f5.mp4, resource_id=853
ğŸ“ [API-UPDATE] ä½¿ç”¨é€šç”¨æ¥å£: https://agent.cstlanbaai.com/gateway/admin-api/agent/task-video-info/update
ğŸ”„ [API-UPDATE] æ›´æ–°ä»»åŠ¡çŠ¶æ€: fb0effda-1780-4124-84a3-abc2346dccd7 -> 1 (type: default)
{'task_id': 'fb0effda-1780-4124-84a3-abc2346dccd7', 'status': '1', 'path': '', 'resourceId': 853, 'id': '1402'}
âœ… [API-UPDATE] çŠ¶æ€æ›´æ–°æˆåŠŸ
âœ… [VGP] ä»»åŠ¡çŠ¶æ€æ›´æ–°ä¸ºå®Œæˆ: task_id=fb0effda-1780-4124-84a3-abc2346dccd7
2025-10-16 05:59:45,717 INFO sqlalchemy.engine.Engine SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
INFO:sqlalchemy.engine.Engine:SELECT tasks.id AS tasks_id, tasks.task_id AS tasks_task_id, tasks.theme AS tasks_theme, tasks.keywords AS tasks_keywords, tasks.target_duration AS tasks_target_duration, tasks.user_description AS tasks_user_description, tasks.config AS tasks_config, tasks.priority AS tasks_priority, tasks.status AS tasks_status, tasks.progress AS tasks_progress, tasks.message AS tasks_message, tasks.result AS tasks_result, tasks.output_url AS tasks_output_url, tasks.error_message AS tasks_error_message, tasks.retry_count AS tasks_retry_count, tasks.created_at AS tasks_created_at, tasks.started_at AS tasks_started_at, tasks.completed_at AS tasks_completed_at, tasks.processing_time AS tasks_processing_time, tasks.project_id AS tasks_project_id
FROM tasks
WHERE tasks.task_id = ?
 LIMIT ? OFFSET ?
 LIMIT ? OFFSET ?
2025-10-16 05:59:45,717 INFO sqlalchemy.engine.Engine [cached since 422.5s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
INFO:sqlalchemy.engine.Engine:[cached since 422.5s ago] ('fb0effda-1780-4124-84a3-abc2346dccd7', 1, 0)
2025-10-16 05:59:45,718 INFO sqlalchemy.engine.Engine UPDATE tasks SET status=?, message=?, result=?, completed_at=?, processing_time=? WHERE tasks.id = ?
INFO:sqlalchemy.engine.Engine:UPDATE tasks SET status=?, message=?, result=?, completed_at=?, processing_time=? WHERE tasks.id = ?
2025-10-16 05:59:45,718 INFO sqlalchemy.engine.Engine [generated in 0.00050s] ('COMPLETED', 'VGPè§†é¢‘ç”Ÿæˆå®Œæˆ', '{"video_type_identification": {"video_type_id": "\\u793e\\u4ea4\\u7c7b", "structure_template_id": {"intro": "\\u5feb\\u901f\\u5c55\\u793a\\u7f8e\\u59 ... (46287 characters truncated) ... "generation_mode": "vgp_new_pipeline", "segments_count": 2}, "vgp_document_path": "/app/vgp_documents/fb0effda-1780-4124-84a3-abc2346dccd7.vgp.json"}', '2025-10-16 05:59:45.717511', 422.503835, 1)
INFO:sqlalchemy.engine.Engine:[generated in 0.00050s] ('COMPLETED', 'VGPè§†é¢‘ç”Ÿæˆå®Œæˆ', '{"video_type_identification": {"video_type_id": "\\u793e\\u4ea4\\u7c7b", "structure_template_id": {"intro": "\\u5feb\\u901f\\u5c55\\u793a\\u7f8e\\u59 ... (46287 characters truncated) ... "generation_mode": "vgp_new_pipeline", "segments_count": 2}, "vgp_document_path": "/app/vgp_documents/fb0effda-1780-4124-84a3-abc2346dccd7.vgp.json"}', '2025-10-16 05:59:45.717511', 422.503835, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
2025-10-16 05:59:45,719 INFO sqlalchemy.engine.Engine COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-10-16 05:59:45,724 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:45,725 INFO sqlalchemy.engine.Engine SELECT tasks.id, tasks.task_id, tasks.theme, tasks.keywords, tasks.target_duration, tasks.user_description, tasks.config, tasks.priority, tasks.status, tasks.progress, tasks.message, tasks.result, tasks.output_url, tasks.error_message, tasks.retry_count, tasks.created_at, tasks.started_at, tasks.completed_at, tasks.processing_time, tasks.project_id
FROM tasks
WHERE tasks.id = ?
2025-10-16 05:59:45,725 INFO sqlalchemy.engine.Engine [cached since 422.8s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 422.8s ago] (1,)
INFO:app:ğŸ“‹ Task fb0effda-1780-4124-84a3-abc2346dccd7 - Node 0: completed - VGPè§†é¢‘ç”Ÿæˆä»»åŠ¡å®Œæˆ
ğŸ‰ [VGP] Task fb0effda-1780-4124-84a3-abc2346dccd7 completed successfully!
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-10-16 05:59:45,725 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-10-16 05:59:45,726 INFO sqlalchemy.engine.Engine ROLLBACK
